#kaldi
kaldi 是一个语音识别工具包，c++开发，编译后产生很多工具，使用shell和perl等脚本串联工具，完成语言识别流程
语言处理
	语音->|adc| ->信号序列
	分frame
		基于短时平稳性假设 
		一般25ms一个frame,移动为10ms.，帧之间有重叠(一般1/4~1/3)
	ASR评价
		多余预测，少预测，词语不对
		WER = （#inserts + #delete + #replace ）/ #words
	ASR 
		 (Y,w) is (语音，词语序列)
		w'  = arg(w)max p(w|Y) 语音对应的词语
		=> p(w|Y) = p (Y|w) * p(w) / p(Y)
		p(Y|w) 声学模型
			单词序列w被拆分为音素序列Q,p(Y|w) = sum(Q) p(Y|Q) * p (Q|w)
			w,Q单词序列对应的发言,Q，Y发音对应的音频特征
			P(Y|Q)一般使用HMM建模
		p(w) 语言模型
	GMM
		加权叠加多个高斯模型，以模拟任意概率分布函数
-----------------------
#实时语音处理实践指南
噪声
	1.非相关噪声
	2.混响
	3.回声 
	4.干扰
	
声学
	发音
		声带伸缩周期性close声门,声带厚则声缩慢，周期(T)大,则频率小
		声带提供了激励信号，声道是线性滤波器，对输入信号频谱整形
	音素
		最小发音单位，	音素 -> 音节 -> 发音
		汉语 元音和辅音组成
			啊 a 1音素
			爱 ai 2音素
			呆 dai 3音素
	室内声音传播	高频在空气散射/反射，低频在室内形成协振
	扬声器
		膜片振动发声
			响度 振动幅度
			音调  振动频率
			音品 膜片材质
		麦克风和扬声器同在的场景下要做回声消除*
	麦克风
		ADC 对声音信号采样
		
语音端点检测
	#唤醒/编码/传输时，无有效语音时不处理，节省资源
	判定给定音频是否存在语音 分类问题，特征->判断模型
	特征 时域/频域
	
单通道降噪
	#降噪一般在频域处理
	加性噪声 y(t) = x(t) + u(t)
	在非语音(噪声)段，建立噪声估计模型u'(t)	，然后x'(t) = y(t) - u'(t)
	正交子空间 噪声和语音处于不同子空间，svd/pca分解
	深度学习
		根据特征估计每个频点的掩码，将掩码和频谱相乘(某些谱点被增强或削弱)，在频域滤波

回声消除
	维纳时域滤波 
		均方误差，梯度下降
	频域滤波
		均方误差，FFT变换频域处理
	一种简单的序列相似性算法
		def bin(s0,s1,thres):
			f0 = fft(s0)
			f1= fft(s1)
			bf0 = f0 > thres;   # 0,1,1,0...
			bf1 = f1 > thres;
			res = bf0 xor bf1
			# 1的个数越少说明越相似
			return 1 / bitcount(res)
声源定位
	到达时间差
	波束形成能量最大

音效处理
	声道 
		录制时不同空间位置的音源数据
		x.y.z 普通音箱数量.低音炮数量.上方顶置音箱数量
		不同声道保存不同音源的数据，并通过不同的扬声器播放出来，打造立体/全景音效

盲源分离
	假定源语音信号具有相互独立的统计特性，利用高阶统计量分离目标语音

网络传输
	一般在视频会议等场景，使用基于UDP传输的RTP协议
	丢包
		编码中就有抗丢包对抗技术
		RTP没有重传机制，重传需要上层协议自己控制
		例子
			将原始不同数据段，交叉打包，若发生丢包，丢失的是不同数据段的小部分数据，而不是某段数据完全丢失
			数据重构后，可以使用插值等方法，预测出丢失的数据
			当重构困难时才考虑重传
	发送端
		RTP包含序列号、时间戳等
		接收RTCP消息(基于丢包率，延迟等)给拥塞控制器，调整比特率
	接受端
		RTCP协议，反馈接受包统计信息	
	BBR 通过瓶颈带宽和RTT计算发包速率

唤醒词识别
	Hi siri! xiaodu xiaodu...
	特征提取
	FBank
		预加重滤波 y(t) = x(t) - u * x(t-1),u~(0.9,1)
		分帧 
			10-30ms一个片段为一帧做fft，包含N个(256/512)采样点，相邻帧包含一些重叠区域
		加窗 矩形窗会导致频谱泄漏，使用hanming / gaosi winodw可削弱旁瓣
		STFT
			以帧为单位的FFT,包含了时/频域信息
			功率谱密度 P = |FFT(xi)|^2 / N 
		梅尔频域滤波器组 提取特征
			人耳 非线性感知，指导中心频率，耳朵对不同频率敏感度分布是不均匀的像一个滤波器组	
			掩闭效应 频率相近的声音容易听差，两个声音频率距离小于它，容易产生此效应
	MFCC
		对FBank的频谱DCT变换，相当于IFFT变换回时域，称为倒谱域
		去相关和压缩
	#FBank和MFCC在模拟人耳搞特征工程
	PCEN 归一化，去除响度对FBank/MFCC的影响
	Deep Kws
		1.增加一个GMM模型做语音端点检测,在有人声的范围序列，对每一帧提取FBank特征
		2.模型输入包含了前后帧的特征拼接(contxt),向前拼接了10 frame,后30 frame
	子带CNN
		频率域划分为不同的子带，重叠/不重叠
		不同卷积核提取不同频率带特征
		沿通道方向组合特征
	perf	
		计算 flops / s, 每秒浮点运算数
		带宽 B/s
		计算密度  计算/带宽 flpos / B, 一字节的io对应多少次浮点计算
		计算密度大 
			计算band 
			计算密度小 io band优化方向不同，合理利用各级缓存（如矩阵分块）
		conv 加速
			减低计算量 fft/winograd 在变换域卷积变乘法，然后反变换
			降低带宽 gemm 方法,im2col (缺点，内存占用增大)
			同时 低精度量化
ASR 
	语音->声学模型
	文本->语言模型
	deepspeech 
		端到端模型 将语音特征序列x->z字符序列
		将字符序列输入语言模型，生成合法的词语/句子z->y
TTS
	文本->语音
	
